<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jasa Suruhan & Antar Jemput</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background: #f5f6fa;
      font-family: 'Poppins', sans-serif;
    }
    .banner img {
      width: 100%;
      border-radius: 16px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    }
    .kategori-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      margin-top: 20px;
    }
    .kategori-item {
      text-align: center;
      background: #fff;
      border-radius: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      padding: 12px;
      transition: 0.3s;
    }
    .kategori-item:hover {
      transform: scale(1.05);
    }
    .kategori-item img {
      width: 60px;
      height: 60px;
      object-fit: contain;
      margin-bottom: 6px;
    }
    .modal-content {
      border-radius: 16px;
    }
    #mapView {
      width: 100%;
      height: 250px;
      border-radius: 10px;
      margin-top: 10px;
    }
  </style>
</head>
<body>

<div class="container my-3">

  <!-- SLIDE BANNER -->
  <div id="banner" class="banner mb-3">
    <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhRChNVFEnMamg4xeg_J9Fkr_3I93wxxk4o6XlG1z8FMwSPS0mlpsb2yPdXa3zdSM5edvwKiUfp36e8LbDary6mH6uUOTVCSsaT5beEW9Qly3xn7CIaToNsZa63wsUHP5q9hjmrG-QhLHN066qercKNZu2ATqe__2R87rdTm4EiWR19DcsFuIddMjyY0bI/s1536/IMG_20251005_083246.png" alt="Banner">
  </div>

  <!-- MENU KATEGORI -->
  <div class="kategori-grid">

    <div class="kategori-item" onclick="bukaForm('Antar Jemput')">
      <img src="https://cdn-icons-png.flaticon.com/512/1152/1152913.png" alt="Antar Jemput">
      <span>Antar Jemput</span>
    </div>

    <div class="kategori-item" onclick="bukaForm('Kirim Paket')">
      <img src="https://cdn-icons-png.flaticon.com/512/679/679720.png" alt="Kirim Paket">
      <span>Kirim Paket</span>
    </div>

    <div class="kategori-item" onclick="bukaForm('Bersih Rumah')">
      <img src="https://cdn-icons-png.flaticon.com/512/3093/3093464.png" alt="Bersih Rumah">
      <span>Bersih Rumah</span>
    </div>

    <div class="kategori-item" onclick="bukaForm('Bersihin Kebun')">
      <img src="https://cdn-icons-png.flaticon.com/512/7666/7666788.png" alt="Bersihin Kebun">
      <span>Bersihin Kebun</span>
    </div>

    <div class="kategori-item" onclick="bukaForm('Tambal Ban')">
      <img src="https://cdn-icons-png.flaticon.com/512/3131/3131642.png" alt="Tambal Ban">
      <span>Tambal Ban</span>
    </div>

    <div class="kategori-item" onclick="bukaForm('Tukang')">
      <img src="https://cdn-icons-png.flaticon.com/512/2271/2271068.png" alt="Tukang">
      <span>Tukang</span>
    </div>

  </div>
</div>

<!-- POPUP FORM -->
<div class="modal fade" id="formModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content p-3">
      <div class="modal-header">
        <h5 class="modal-title">Form Pesanan</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form id="orderForm">
          <input type="hidden" id="jasaDipilih">

          <div class="mb-2">
            <label>Nama:</label>
            <input type="text" class="form-control" id="nama" required>
          </div>

          <div class="mb-2">
            <label>Titik Jemput:</label>
            <div class="input-group">
              <input type="text" id="titikJemput" class="form-control" readonly>
              <button type="button" class="btn btn-success" onclick="setLokasi()">Set Lokasi</button>
            </div>
          </div>

          <div class="mb-2">
            <label>Detail Alamat Jemput:</label>
            <input type="text" class="form-control" id="detailAlamat">
          </div>

          <div class="mb-2">
            <label>Alamat Tujuan:</label>
            <input type="text" class="form-control" id="tujuan">
          </div>

          <div id="estimasiSection" style="display:none;">
            <div class="mb-2">
              <label>Jarak (KM):</label>
              <input type="number" class="form-control" id="jarak" min="1" oninput="hitungEstimasi()">
            </div>

            <div class="mb-2">
              <label>Estimasi Biaya:</label>
              <input type="text" class="form-control" id="estimasi" readonly>
            </div>
          </div>

          <div class="mb-2">
            <label>Metode Bayar:</label>
            <select class="form-select" id="metode">
              <option value="CASH DRIVER">CASH DRIVER</option>
              <option value="TRANSFER">TRANSFER</option>
              <option value="QRIS">QRIS</option>
            </select>
          </div>

          <div id="mapView"></div>

          <button type="button" class="btn btn-primary w-100 mt-3" onclick="kirimPesanan()">Kirim Pesanan</button>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- SCRIPTS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  let jasaTerpilih = '';
  let userLat = '';
  let userLng = '';

  function bukaForm(jasa) {
    jasaTerpilih = jasa;
    document.getElementById("jasaDipilih").value = jasa;
    document.getElementById("orderForm").reset();
    document.getElementById("estimasiSection").style.display =
      (jasa === "Antar Jemput" || jasa === "Kirim Paket") ? "block" : "none";
    new bootstrap.Modal(document.getElementById("formModal")).show();
  }

  function setLokasi() {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(function(pos) {
        userLat = pos.coords.latitude;
        userLng = pos.coords.longitude;
        const mapsUrl = `https://www.google.com/maps?q=${userLat},${userLng}`;
        document.getElementById("titikJemput").value = mapsUrl;

        const mapFrame = `<iframe width="100%" height="250" style="border-radius:10px;" src="https://www.google.com/maps?q=${userLat},${userLng}&hl=id&z=15&output=embed"></iframe>`;
        document.getElementById("mapView").innerHTML = mapFrame;
      });
    } else {
      alert("Perizinan lokasi tidak tersedia.");
    }
  }

  function hitungEstimasi() {
    let km = parseFloat(document.getElementById("jarak").value) || 0;
    let total = km * 4000;
    let sisa = total % 1000;
    if (sisa >= 500) total += (1000 - sisa);
    else total -= sisa;
    document.getElementById("estimasi").value = "Rp " + total.toLocaleString();
  }

  function kirimPesanan() {
    const nama = document.getElementById("nama").value;
    const titik = document.getElementById("titikJemput").value;
    const alamat = document.getElementById("detailAlamat").value;
    const tujuan = document.getElementById("tujuan").value;
    const metode = document.getElementById("metode").value;
    const jarak = document.getElementById("jarak").value;
    const estimasi = document.getElementById("estimasi").value;

    let pesan = `*PESANAN ${jasaTerpilih.toUpperCase()}*\nNama: ${nama}\nTitik Jemput: ${titik}\nAlamat Jemput: ${alamat}\nTujuan: ${tujuan}\nMetode Bayar: ${metode}`;

    if (jasaTerpilih === "Antar Jemput" || jasaTerpilih === "Kirim Paket") {
      pesan += `\nJarak: ${jarak} KM\nEstimasi Biaya: ${estimasi}`;
    } else {
      pesan += `\nCatatan: Mohon info biaya ke petugas (NEGO dulu).`;
    }

    pesan += `\n\nLink Maps: ${titik}`;

    const waUrl = `https://wa.me/6281262433533?text=${encodeURIComponent(pesan)}`;
    window.open(waUrl, "_blank");
  }
</script>
</body>
</html>
